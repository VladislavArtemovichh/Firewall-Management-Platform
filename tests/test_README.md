# üß™ –¢–µ—Å—Ç—ã –¥–ª—è Firewall Management Platform

–≠—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞–º–∏.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ __init__.py                              # –ü–∞–∫–µ—Ç —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ conftest.py                              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest –∏ —Ñ–∏–∫—Å—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ test_models.py                           # –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ test_utils.py                            # –¢–µ—Å—Ç—ã —É—Ç–∏–ª–∏—Ç
‚îú‚îÄ‚îÄ test_security.py                         # –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ test_api.py                              # –¢–µ—Å—Ç—ã API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ test_metrics.py                          # –¢–µ—Å—Ç—ã –º–µ—Ç—Ä–∏–∫
‚îú‚îÄ‚îÄ test_middleware.py                       # –¢–µ—Å—Ç—ã middleware
‚îú‚îÄ‚îÄ test_network_monitor.py                  # –¢–µ—Å—Ç—ã —Å–µ—Ç–µ–≤–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚îú‚îÄ‚îÄ test_database.py                         # –¢–µ—Å—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ test_connections_api.py                  # –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã connections API
‚îú‚îÄ‚îÄ test_firewall_devices_api.py             # –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã firewall devices API
‚îú‚îÄ‚îÄ test_routes_improved.py                  # –¢–µ—Å—Ç—ã routes
‚îú‚îÄ‚îÄ test_connections_api_improved.py         # –¢–µ—Å—Ç—ã connections API
‚îú‚îÄ‚îÄ test_firewall_devices_api_improved.py    # –¢–µ—Å—Ç—ã firewall devices API
‚îú‚îÄ‚îÄ validation.py                            # –¢–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ README.md                                # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

```bash
# –ò—Å–ø–æ–ª—å–∑—É—è —Å–∫—Ä–∏–ø—Ç
python run_tests.py all

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
python -m pytest tests/ -v --cov=app --cov-report=html:htmlcov
```

### –ó–∞–ø—É—Å–∫ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø —Ç–µ—Å—Ç–æ–≤

```bash
# –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
python run_tests.py unit

# –¢–æ–ª—å–∫–æ integration —Ç–µ—Å—Ç—ã
python run_tests.py integration

# –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã (–±–µ–∑ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö)
python run_tests.py fast

# –° –¥–µ—Ç–∞–ª—å–Ω—ã–º –æ—Ç—á–µ—Ç–æ–º –ø–æ–∫—Ä—ã—Ç–∏—è
python run_tests.py coverage

# –ó–∞–ø—É—Å–∫ —É–ª—É—á—à–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
python -m pytest tests/test_routes_improved.py -v
python -m pytest tests/test_connections_api_improved.py -v
python -m pytest tests/test_firewall_devices_api_improved.py -v
```

## üìä –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞

–¢–µ—Å—Ç—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –ø–æ–∫—Ä—ã—Ç–∏–µ —Å–ª–µ–¥—É—é—â–∏—Ö –º–æ–¥—É–ª–µ–π:

- **models.py** - –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è
- **utils.py** - –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
- **security.py** - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **metrics.py** - –°–±–æ—Ä –∏ –∞–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫
- **routes.py** - API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- **connections_api.py** - API –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **firewall_devices_api.py** - API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- **validation.py** - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### üéØ –¢–µ–∫—É—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ

| –ú–æ–¥—É–ª—å | –ü–æ–∫—Ä—ã—Ç–∏–µ | –°—Ç–∞—Ç—É—Å |
|--------|----------|--------|
| **routes.py** | 85%+ | ‚úÖ –£–ª—É—á—à–µ–Ω–æ |
| **connections_api.py** | 80%+ | ‚úÖ –£–ª—É—á—à–µ–Ω–æ |
| **firewall_devices_api.py** | 85%+ | ‚úÖ –£–ª—É—á—à–µ–Ω–æ |
| **–û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ** | 85%+ | ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ |

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–æ–∫—Ä—ã—Ç–∏—é

- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ**: 80%
- **–¶–µ–ª–µ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ**: 90%
- **–¢–µ–∫—É—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ**: 85%+ ‚úÖ

### –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—á–µ—Ç–æ–≤ –ø–æ–∫—Ä—ã—Ç–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º:

1. **HTML –æ—Ç—á–µ—Ç**: `htmlcov/index.html`
2. **–ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç**: –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª
3. **XML –æ—Ç—á–µ—Ç**: `coverage.xml` (–¥–ª—è CI/CD)

## üß™ –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### Unit —Ç–µ—Å—Ç—ã

–¢–µ—Å—Ç–∏—Ä—É—é—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –∫–ª–∞—Å—Å—ã –≤ –∏–∑–æ–ª—è—Ü–∏–∏:

- `test_models.py` - –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π –¥–∞–Ω–Ω—ã—Ö
- `test_utils.py` - –¢–µ—Å—Ç—ã —É—Ç–∏–ª–∏—Ç
- `test_security.py` - –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `test_metrics.py` - –¢–µ—Å—Ç—ã –º–µ—Ç—Ä–∏–∫
- `test_validation.py` - –¢–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### Integration —Ç–µ—Å—Ç—ã

–¢–µ—Å—Ç–∏—Ä—É—é—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏:

- `test_api.py` - –¢–µ—Å—Ç—ã API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- `test_database.py` - –¢–µ—Å—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `test_middleware.py` - –¢–µ—Å—Ç—ã middleware

### –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

#### `test_routes_improved.py` - –¢–µ—Å—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤:**
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: login, logout, rate limiting
- **–î–∞—à–±–æ—Ä–¥**: –¥–æ—Å—Ç—É–ø, –º–µ—Ç—Ä–∏–∫–∏, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**: CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏, —Ä–æ–ª–∏
- **–ü—Ä–∞–≤–∏–ª–∞ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞**: —Å–æ–∑–¥–∞–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ < 200ms
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: SQL –∏–Ω—ä–µ–∫—Ü–∏–∏, XSS, CSRF
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: 404, 500, –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **Middleware**: CORS, security headers, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### `test_connections_api_improved.py` - –¢–µ—Å—Ç—ã API —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤:**
- **–ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π**: TCP, UDP, hostname
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É, IP, –ø–æ—Ä—Ç—É, —Å–æ—Å—Ç–æ—è–Ω–∏—é
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º, —Å–æ—Å—Ç–æ—è–Ω–∏—è–º
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –∑–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞, —Å—Ç–∞—Ç—É—Å, –∏—Å—Ç–æ—Ä–∏—è
- **–ê–ª–µ—Ä—Ç—ã**: —Å–æ–∑–¥–∞–Ω–∏–µ, –ø–æ–ª—É—á–µ–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –¥–∏–∞–ø–∞–∑–æ–Ω—ã –ø–æ—Ä—Ç–æ–≤

#### `test_firewall_devices_api_improved.py` - –¢–µ—Å—Ç—ã API —É—Å—Ç—Ä–æ–π—Å—Ç–≤

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤:**
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏**: CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- **SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è**: —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å—Ç–∞—Ç—É—Å, –æ—à–∏–±–∫–∏
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP**: —Å–æ–∑–¥–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ, –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ DNS**: –¥–æ–º–µ–Ω—ã, –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤**: –ø–æ–ª—É—á–µ–Ω–∏–µ, —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞, —Ç–∞–π–º–∞—É—Ç—ã SSH
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: SQL –∏–Ω—ä–µ–∫—Ü–∏–∏, –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –æ—à–∏–±–∫–∏ SSH

### –§–∏–∫—Å—Ç—É—Ä—ã

–í `conftest.py` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –æ–±—â–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã:

- `sample_firewall_rule` - –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞
- `sample_firewall_device` - –¢–µ—Å—Ç–æ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- `clear_login_attempts` - –û—á–∏—Å—Ç–∫–∞ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- `mock_time` - –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏

## üè∑Ô∏è –ú–∞—Ä–∫–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞—Ä–∫–µ—Ä—ã –¥–ª—è –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤:

```bash
# –¢–æ–ª—å–∫–æ –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest -m slow

# –ò—Å–∫–ª—é—á–∏—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest -m "not slow"

# –¢–æ–ª—å–∫–æ integration —Ç–µ—Å—Ç—ã
pytest -m integration

# –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
pytest -m "not integration"

# üÜï –¢–æ–ª—å–∫–æ —É–ª—É—á—à–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest -m improved

# üÜï –¢–æ–ª—å–∫–æ security —Ç–µ—Å—Ç—ã
pytest -m security

# üÜï –¢–æ–ª—å–∫–æ performance —Ç–µ—Å—Ç—ã
pytest -m performance
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### pytest.ini

–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ pytest:

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤
- –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –ú–∞—Ä–∫–µ—Ä—ã –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç—á–µ—Ç–æ–≤

### .coveragerc

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞:

- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å—Ç—Ä–æ–∫
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç—á–µ—Ç–æ–≤

## üìù –ù–∞–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∞

```python
import pytest
from app.module import function

class TestFunction:
    """–¢–µ—Å—Ç—ã –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ function"""
    
    def test_function_success(self):
        """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è"""
        result = function("test_input")
        assert result == "expected_output"
    
    def test_function_error(self):
        """–¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–∫–∏"""
        with pytest.raises(ValueError):
            function("invalid_input")
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä

```python
def test_with_fixture(sample_firewall_rule):
    """–¢–µ—Å—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ–∏–∫—Å—Ç—É—Ä—ã"""
    assert sample_firewall_rule.name == "Test Rule"
```

### –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
from unittest.mock import patch, Mock

def test_with_mock():
    """–¢–µ—Å—Ç —Å –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ–º"""
    with patch('app.module.external_function') as mock_func:
        mock_func.return_value = "mocked_result"
        result = function_under_test()
        assert result == "mocked_result"
```

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ò–º–ø–æ—Ä—Ç –æ—à–∏–±–∫–∏**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PYTHONPATH –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤, –Ω–µ —Ç—Ä–µ–±—É—é—â–∏—Ö —Ä–µ–∞–ª—å–Ω–æ–π –ë–î
3. **–í–Ω–µ—à–Ω–∏–µ API**: –í—Å–µ–≥–¥–∞ –º–æ–∫–∏—Ä—É–π—Ç–µ –≤–Ω–µ—à–Ω–∏–µ –≤—ã–∑–æ–≤—ã

### –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å–∫ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
pytest -v -s

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
pytest tests/test_module.py::TestClass::test_method

# –ó–∞–ø—É—Å–∫ —Å –æ—Ç–ª–∞–¥—á–∏–∫–æ–º
pytest --pdb

# üÜï –ó–∞–ø—É—Å–∫ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=app --cov-report=term-missing
```

## üîÑ CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### GitHub Actions

```yaml
- name: Run tests
  run: |
    python -m pytest tests/ --cov=app --cov-report=xml
    coverage report --fail-under=80
```

### GitLab CI

```yaml
test:
  script:
    - python -m pytest tests/ --cov=app --cov-report=xml
    - coverage report --fail-under=80
```

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞

- **–¶–µ–ª—å**: >80%
- **–¢–µ–∫—É—â–µ–µ**: 85%+ ‚úÖ

### –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

- **Unit —Ç–µ—Å—Ç—ã**: <30 —Å–µ–∫—É–Ω–¥
- **Integration —Ç–µ—Å—Ç—ã**: <2 –º–∏–Ω—É—Ç
- **–ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä**: <5 –º–∏–Ω—É—Ç
- **–£–ª—É—á—à–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**: <3 –º–∏–Ω—É—Ç

### –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

- **–¶–µ–ª—å**: 100% –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ
- **–ü–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å**: –í—Å–µ —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏

## –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Security Testing

```python
def test_sql_injection_prevention(self):
    """–¢–µ—Å—Ç –∑–∞—â–∏—Ç—ã –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π"""
    malicious_input = "'; DROP TABLE users; --"
    response = client.post("/api/users", json={"username": malicious_input})
    assert response.status_code == 422  # –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

def test_xss_prevention(self):
    """–¢–µ—Å—Ç –∑–∞—â–∏—Ç—ã –æ—Ç XSS –∞—Ç–∞–∫"""
    xss_input = "<script>alert('XSS')</script>"
    response = client.post("/api/firewall-rules", json={"name": xss_input})
    assert response.status_code == 422
```

### Performance Testing

```python
def test_api_response_time(self):
    """–¢–µ—Å—Ç –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ API"""
    start_time = time.time()
    response = client.get("/api/dashboard")
    response_time = time.time() - start_time
    
    assert response_time < 0.2  # < 200ms
    assert response.status_code == 200

def test_concurrent_requests(self):
    """–¢–µ—Å—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤"""
    import threading
    
    def make_request():
        response = client.get("/api/dashboard")
        assert response.status_code == 200
    
    threads = [threading.Thread(target=make_request) for _ in range(10)]
    for thread in threads:
        thread.start()
    for thread in threads:
        thread.join()
```

### Validation Testing

```python
def test_input_validation(self):
    """–¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
    invalid_data = {
        "username": "",  # –ü—É—Å—Ç–æ–µ –∏–º—è
        "password": "weak",  # –°–ª–∞–±—ã–π –ø–∞—Ä–æ–ª—å
        "ip_address": "invalid_ip"  # –ù–µ–≤–µ—Ä–Ω—ã–π IP
    }
    
    response = client.post("/api/users", json=invalid_data)
    assert response.status_code == 422
    
    errors = response.json()["detail"]
    assert len(errors) > 0  # –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```

## ü§ù –í–∫–ª–∞–¥ –≤ —Ç–µ—Å—Ç—ã

1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–µ —Å–Ω–∏–∂–∞–µ—Ç—Å—è
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤
4. –û–±–Ω–æ–≤–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
5. –î–æ–±–∞–≤—å—Ç–µ security –∏ performance —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö API

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [pytest –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.pytest.org/)
- [pytest-cov –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://pytest-cov.readthedocs.io/)
- [unittest.mock –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.python.org/3/library/unittest.mock.html)
- [FastAPI testing guide](https://fastapi.tiangolo.com/tutorial/testing/)
- [Security testing best practices](https://owasp.org/www-project-web-security-testing-guide/)
